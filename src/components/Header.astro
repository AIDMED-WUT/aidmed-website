---
interface Props {
  lang: 'pl' | 'en';
  alternateHref: string;
  currentPath: string;
}

const { lang, alternateHref, currentPath } = Astro.props;

const isEn = lang === 'en';

const base = import.meta.env.BASE_URL.replace(/\/$/, '');

const navLinks = isEn
  ? [
      { href: `${base}/en/`, label: 'Home' },
      { href: `${base}/en/team`, label: 'Team' },
      { href: `${base}/en/seminars`, label: 'Seminars' },
      { href: `${base}/en/publications`, label: 'Publications' },
      { href: `${base}/en/projects`, label: 'Projects' },
      { href: `${base}/en/contact`, label: 'Contact' },
    ]
  : [
      { href: `${base}/`, label: 'Strona główna' },
      { href: `${base}/zespol`, label: 'Zespół' },
      { href: `${base}/seminaria`, label: 'Seminaria' },
      { href: `${base}/publikacje`, label: 'Publikacje' },
      { href: `${base}/projekty`, label: 'Projekty' },
      { href: `${base}/kontakt`, label: 'Kontakt' },
    ];

function isActive(href: string) {
  if (href === `${base}/` || href === `${base}/en/`) return currentPath === href;
  return currentPath.startsWith(href);
}

function linkClass(href: string) {
  const base = 'text-sm font-medium no-underline transition-colors';
  return isActive(href)
    ? `${base} text-szafirowy border-b-2 border-szafirowy pb-0.5`
    : `${base} text-grafitowy hover:text-szafirowy`;
}
---

<header class="border-b border-gray-200 bg-white sticky top-0 z-50">
  <div class="max-w-5xl mx-auto px-4 sm:px-6">
    <div class="flex items-center justify-between h-14">
      <!-- Logo -->
      <a
        href={isEn ? `${base}/en/` : `${base}/`}
        class="text-grafitowy font-bold text-xl tracking-tight no-underline hover:text-szafirowy transition-colors"
      >
        AIDMED
      </a>

      <!-- Desktop Nav -->
      <nav class="hidden md:flex items-center gap-6" aria-label="Navigation">
        {navLinks.map(({ href, label }) => (
          <a href={href} class={linkClass(href)}>
            {label}
          </a>
        ))}
      </nav>

      <!-- Language Switcher -->
      <a
        href={base + alternateHref}
        class="text-sm font-medium text-grafitowy hover:text-szafirowy no-underline border border-gray-300 rounded px-2.5 py-1 transition-colors hover:border-szafirowy"
        title={isEn ? 'Przełącz na polski' : 'Switch to English'}
      >
        {isEn ? 'PL' : 'EN'}
      </a>
    </div>

    <!-- Mobile Nav -->
    <nav class="md:hidden flex overflow-x-auto gap-4 pb-2 -mx-1 px-1" aria-label="Mobile navigation">
      {navLinks.map(({ href, label }) => (
        <a href={href} class={linkClass(href) + ' whitespace-nowrap'}>
          {label}
        </a>
      ))}
    </nav>
  </div>
</header>
