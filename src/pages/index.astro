---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { getCollection } from 'astro:content';

const seminars = await getCollection('seminars');
seminars.sort((a, b) => b.data.date.localeCompare(a.data.date));
const latestSeminar = seminars[0];

const publications = await getCollection('publications');
publications.sort((a, b) => b.data.year - a.data.year);
const latestPub = publications[0];

const team = await getCollection('team');
const activeCount = team.filter(m => m.data.active).length;

const jsonLd = {
  '@context': 'https://schema.org',
  '@type': 'Organization',
  name: 'AIDMED',
  description: 'Nieformalna grupa badawcza zajmująca się komputerowo wspomaganą diagnostyką obrazów medycznych.',
  url: 'https://pages.mini.pw.edu.pl/~aidmed/',
  email: 'aidmed.mini@pw.edu.pl',
  address: {
    '@type': 'PostalAddress',
    streetAddress: 'ul. Koszykowa 75',
    addressLocality: 'Warszawa',
    postalCode: '00-662',
    addressCountry: 'PL',
  },
  parentOrganization: {
    '@type': 'CollegeOrUniversity',
    name: 'Politechnika Warszawska',
  },
};
---

<Layout
  title="AIDMED – Sztuczna Inteligencja w Medycynie | Wydział MiNI PW"
  description="Grupa badawcza AIDMED – komputerowo wspomagana diagnostyka obrazów medycznych. Wydział MiNI, Politechnika Warszawska."
  lang="pl"
  alternateHref="/en/"
  altLang="en"
  jsonLd={jsonLd}
>
  <Header lang="pl" alternateHref="/en/" currentPath="/" />

  <main class="flex-1">
    <!-- Hero -->
    <section class="bg-grafitowy text-white py-16 sm:py-20">
      <div class="max-w-3xl mx-auto px-4 sm:px-6 text-center">
        <h1 class="text-4xl sm:text-5xl font-bold tracking-tight mb-3">AIDMED</h1>
        <p class="text-szafirowy text-lg sm:text-xl font-medium mb-6">
          Artificial Intelligence in Medicine
        </p>
        <p class="text-gray-300 text-base sm:text-lg leading-relaxed max-w-2xl mx-auto">
          Nieformalny zespół naukowców i doktorantów zajmujących się komputerowo wspomaganą diagnostyką obrazów medycznych.
        </p>
      </div>
    </section>

    <!-- Content -->
    <div class="max-w-3xl mx-auto px-4 sm:px-6 py-12">

      <!-- About -->
      <section class="mb-12">
        <h2 class="text-xl font-semibold text-grafitowy mb-4">O grupie</h2>
        <p class="text-gray-700 leading-relaxed">
          AIDMED (<em>Artificial Intelligence in MEDicine</em>) to nieformalna grupa pracowników i doktorantów
          Wydziału Matematyki i Nauk Informacyjnych Politechniki Warszawskiej, zainteresowanych
          komputerowo wspomaganą diagnostyką obrazów medycznych. Działamy od 2006 roku w Zakładzie
          Projektowania Systemów CAD/CAM i Komputerowego Wspomagania Medycyny.
        </p>
        <p class="text-gray-700 leading-relaxed mt-3">
          Nasze badania koncentrują się na automatycznej analizie obrazów TK (diagnostyka udaru mózgu)
          i mammografii (wykrywanie raka piersi), a także na metodach compressed sensing i reprezentacji
          wiedzy medycznej.
        </p>
      </section>

      <!-- Highlight cards -->
      <section class="grid sm:grid-cols-3 gap-4 mb-12">

        <!-- Latest seminar -->
        <div class="bg-surface rounded-lg p-5 border border-gray-100">
          <p class="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2">Ostatnie seminarium</p>
          {latestSeminar ? (
            <>
              <p class="text-sm font-medium text-grafitowy leading-snug">{latestSeminar.data.title_pl ?? latestSeminar.data.title}</p>
              <p class="text-xs text-gray-500 mt-1">{latestSeminar.data.speaker}</p>
              <p class="text-xs text-gray-400 mt-1">
                {new Date(latestSeminar.data.date).toLocaleDateString('pl-PL', { year: 'numeric', month: 'long', day: 'numeric' })}
              </p>
            </>
          ) : (
            <p class="text-sm text-gray-500">Brak danych</p>
          )}
          <a href="/seminaria" class="mt-3 text-xs text-szafirowy hover:underline block">Wszystkie seminaria →</a>
        </div>

        <!-- Recent publication -->
        <div class="bg-surface rounded-lg p-5 border border-gray-100">
          <p class="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2">Ostatnia publikacja</p>
          {latestPub ? (
            <>
              <p class="text-sm font-medium text-grafitowy leading-snug">{latestPub.data.title}</p>
              <p class="text-xs text-gray-500 mt-1">{latestPub.data.authors[0]}{latestPub.data.authors.length > 1 ? ' i in.' : ''}, {latestPub.data.year}</p>
            </>
          ) : (
            <p class="text-sm text-gray-500">Brak danych</p>
          )}
          <a href="/publikacje" class="mt-3 text-xs text-szafirowy hover:underline block">Wszystkie publikacje →</a>
        </div>

        <!-- Team size -->
        <div class="bg-surface rounded-lg p-5 border border-gray-100">
          <p class="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2">Członkowie zespołu</p>
          <p class="text-3xl font-bold text-szafirowy">{activeCount}</p>
          <p class="text-sm text-gray-500 mt-1">badaczy</p>
          <a href="/zespol" class="mt-3 text-xs text-szafirowy hover:underline block">Poznaj zespół →</a>
        </div>
      </section>

      <!-- Navigation links -->
      <section>
        <h2 class="text-xl font-semibold text-grafitowy mb-4">Nawigacja</h2>
        <div class="grid sm:grid-cols-2 gap-3">
          {[
            { href: '/zespol', label: 'Zespół', desc: 'Pracownicy i doktoranci grupy' },
            { href: '/seminaria', label: 'Seminaria', desc: 'Seria „Informatyka w Medycynie i Biologii"' },
            { href: '/publikacje', label: 'Publikacje', desc: 'Artykuły, monografie i prace konferencyjne' },
            { href: '/projekty', label: 'Projekty', desc: 'Projekty badawcze i baza danych DDIS' },
            { href: '/kontakt', label: 'Kontakt', desc: 'Adres i dane kontaktowe' },
          ].map(({ href, label, desc }) => (
            <a
              href={href}
              class="flex flex-col p-4 border border-gray-200 rounded-lg hover:border-szafirowy hover:bg-surface transition-colors no-underline"
            >
              <span class="font-medium text-grafitowy">{label}</span>
              <span class="text-sm text-gray-500 mt-0.5">{desc}</span>
            </a>
          ))}
        </div>
      </section>
    </div>
  </main>

  <Footer lang="pl" />
</Layout>
